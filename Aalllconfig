import Realm from 'realm';

const ArcCurrResultValuesSchema = {
  name: 'ArcCurrResultValues',
  properties: {
    iarc: 'string',
    iarc_14300: 'string',
    iarc_2700: 'string?',
    iarc_600: 'string?',
    correctionfactor: 'string?',
  },
};

const IncidentEnergyResultValuesSchema = {
  name: 'IncidentEnergyResultValues',
  properties: {
    i_energy: 'string?',
    i_e14300: 'string?',
    I_e2700: 'string?',
    i_e600: 'string?',
  },
};

const ArcFlashBoundaryResultValuesSchema = {
  name: 'ArcFlashBoundaryResultValues',
  properties: {
    afb: 'string',
    afb_14300: 'string',
    iarc_2700: 'string?',
    iarc_600: 'string?',
  },
};

const PpeByLocationSchema = {
  name: 'PpeByLocation',
  properties: {
    ppecategory: 'string?',
    incidentenergyrange: 'string',
    clothings: 'string',
  },
};

const ArcCurrentResultSchema = {
  name: 'ArcCurrentResult',
  properties: {
    intemidate_arccurrresultvalues: 'ArcCurrResultValues',
    intemidate_incidentenergyresultvalues: 'IncidentEnergyResultValues',
    intermidate_arcflashboundaryresultvalues: 'ArcFlashBoundaryResultValues',
    arc_current: 'string',
    ppecategorystd: 'string?',
    arc_flashboundary: 'string',
    arc_incidentenergy: 'string',
    arc_time: 'string',
    ppebylocation: 'PpeByLocation',
  },
};

const ArcCalcResultSchema = {
  name: 'ArcCalcResult',
  properties: {
    cf: 'float',
    normal_arccurrentresult: 'ArcCurrentResult',
    reduce_arccurrentresult: 'ArcCurrentResult',
  },
};

const EquipmentDetailsSchema = {
  name: 'EquipmentDetails',
  properties: {
    systemtype: 'string',
    type: 'string',
    systemratedvolt: 'float',
    systemratedvolt_unit: 'string',
    faultcurrent: 'float',
    faultcurrent_unit: 'string',
    faultclearingtime: 'float',
    faultclearingtime_unit: 'string',
    measurementtype: 'string',
    workingdistance: 'float',
    workingdistance_unit: 'string',
    arcduration: 'float',
    arcduration_unit: 'string',
    enclosurewidth: 'float',
    enclosurewidth_unit: 'string',
    enclosureheight: 'float',
    enclosureheight_unit: 'string',
    enclosuredepth: 'float',
    enclosuredepth_unit: 'string',
    electrodeconfiguration: 'string',
    electrodegap: 'float',
    electrodegap_unit: 'string',
    isratedlessthan200: 'bool?',
  },
};

const EquipmentInfoSchema = {
  name: 'EquipmentInfo',
  properties: {
    Id: 'string',
    name: 'string',
    description: 'string?',
    location: 'string',
    equipmentdetails: 'EquipmentDetails',
  },
};

const ArcAnalysisSchema = {
  name: 'ArcAnalysis',
  primaryKey: 'id',
  properties: {
    id: 'string',
    documentversion: 'string?',
    organizationId: 'string',
    locationId: 'string',
    siteId: 'string?',
    jobId: 'string',
    arcopertiontype: 'string',
    status: 'string',
    startapptimestamp: 'int',
    endapptimestamp: 'int',
    createdby: 'string',
    createdwhen: 'date',
    modifiedby: 'string',
    modifiedwhen: 'date',
    equipmentinfo: 'EquipmentInfo',
    ppecategoryresult: 'string?',
    arccalcresult: 'ArcCalcResult',
    isdeleted: 'bool',
    message: 'string',
    sasToken: 'string',
  },
};

const realmConfig = {
  schema: [
    ArcCurrResultValuesSchema,
    IncidentEnergyResultValuesSchema,
    ArcFlashBoundaryResultValuesSchema,
    PpeByLocationSchema,
    ArcCurrentResultSchema,
    ArcCalcResultSchema,
    EquipmentDetailsSchema,
    EquipmentInfoSchema,
    ArcAnalysisSchema,
  ],
  schemaVersion: 1,
};

export default realmConfig;





/////save


import Realm from 'realm';
import realmConfig from './realmConfig';

const saveArcAnalysisData = async (data) => {
  const realm = await Realm.open(realmConfig);

  realm.write(() => {
    data.values.forEach(value => {
      // Convert timestamp strings to Date objects
      value.createdwhen = new Date(value.createdwhen);
      value.modifiedwhen = new Date(value.modifiedwhen);

      // Create or update the ArcAnalysis object
      realm.create('ArcAnalysis', value, 'modified');
    });
  });

  realm.close();
};

// Example JSON response (your actual data will come from an API call or similar)
const jsonResponse = {
  "message": "Arc Analysis result data retrieved successfully.",
  "data": {
    "values": [
      {
        "id": "226c7536-e39a-4d50-9dd6-140caadfd602",
        "documentversion": null,
        "organizationId": "381be7ac-5ec6-4b04-9c2b-bac2e89149f3",
        "locationId": "3b9719eb-d759-426b-a32c-d91ae1b11a72",
        "siteId": null,
        "jobId": "Test1",
        "arcopertiontype": "IEEE15842018",
        "status": "Completed",
        "startapptimestamp": 1718030550596,
        "endapptimestamp": 1718030870619,
        "createdby": "casey_uat_siteuser@esda.com",
        "createdwhen": "2024-06-10T14:47:51.1316866+00:00",
        "modifiedby": "casey_uat_siteuser@esda.com",
        "modifiedwhen": "2024-06-10T14:47:51.1316866+00:00",
        "equipmentinfo": {
          "Id": "Equip1",
          "name": "Equip1",
          "description": null,
          "location": "West",
          "equipmentdetails": {
            "systemtype": "AC",
            "type": "VClassSwitchGear",
            "systemratedvolt": 1500.0,
            "systemratedvolt_unit": "volt",
            "faultcurrent": 20.0,
            "faultcurrent_unit": "kA",
            "faultclearingtime": 0.0,
            "faultclearingtime_unit": "ms",
            "measurementtype": "Imperical",
            "workingdistance": 24.0,
            "workingdistance_unit": "In",
            "arcduration": 0.0,
            "arcduration_unit": "ms",
            "enclosurewidth": 1.0,
            "enclosurewidth_unit": "In",
            "enclosureheight": 40.0,
            "enclosureheight_unit": "In",
            "enclosuredepth": 19.7,
            "enclosuredepth_unit": "In",
            "electrodeconfiguration": "VCB",
            "electrodegap": 1.2,
            "electrodegap_unit": "In",
            "isratedlessthan200": null,
          },
        },
        "ppecategoryresult": null,
        "arccalcresult": {
          "cf": 1.1929993483995172,
          "normal_arccurrentresult": {
            "intemidate_arccurrresultvalues": {
              "iarc": "17.0453523918773",
              "iarc_14300": "19.036764921903874",
              "iarc_2700": "17.490069391585607",
              "iarc_600": "16.338127498966102",
              "correctionfactor": null,
            },
            "intemidate_incidentenergyresultvalues": {
              "i_energy": null,
              "i_e14300": null,
              "I_e2700": null,
              "i_e600": null,
            },
            "intermidate_arcflashboundaryresultvalues": {
              "afb": "1072.4015355141123",
              "afb_14300": "1253.087189951422


